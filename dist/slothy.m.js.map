{"version":3,"file":"slothy.m.js","sources":["../src/index.js"],"sourcesContent":["/**\n * Lazy load images\n *\n * @param {Object=} options Configuration options for slothy\n * @param {String|Number} options.offset Offset from image in px to start loading, defaults to 100px\n * @param {Number} options.threshold Either a single number or an array of numbers which indicate\n *                                   at what percentage of the target's visibility the observer's callback should be executed.\n * @param {Function} options.onLoad Function triggered when image is done loading\n * @param {String} options.dataSelector Data selector on element. Default is \"slothy\"\n */\nfunction slothy ({ offset = 100, threshold = 0.01, onLoad, dataSelector = 'slothy' } = {}) {\n  const images = Array.from(document.querySelectorAll(`[data-${dataSelector}]`))\n\n  if (!('IntersectionObserver' in window)) {\n    images.forEach(image => preloadImage(image))\n    return images\n  }\n\n  const rootMargin = `${offset}px 0px`\n  const config = {\n    rootMargin,\n    threshold\n  }\n\n  function onIntersection (entries) {\n    entries.forEach(entry => {\n      if (entry.intersectionRatio > 0) {\n        observer.unobserve(entry.target)\n        preloadImage(entry.target)\n      }\n    })\n  }\n\n  function preloadImage (image) {\n    const src = image.dataset[dataSelector]\n\n    if (!src) {\n      return\n    }\n\n    image.src = src\n    image.onload = () => {\n      onLoad && onLoad(image)\n      delete image.dataset[dataSelector]\n    }\n  }\n\n  const observer = new IntersectionObserver(onIntersection, config)\n\n  images.forEach(image => observer.observe(image))\n\n  return images\n}\n\nexport default slothy\n"],"names":["ref","onLoad","const","images","Array","from","document","querySelectorAll","dataSelector","window","forEach","image","preloadImage","src","dataset","onload","observer","IntersectionObserver","entries","entry","intersectionRatio","unobserve","target","offset","threshold","observe"],"mappings":"eAUA,SAAiBA,oDAAW,sCAAiB,SAAMC,2CAAuB,UACxEC,IAAMC,EAASC,MAAMC,KAAKC,SAASC,0BAA0BC,QAE7D,KAAM,yBAA0BC,QAE9B,OADAN,EAAOO,iBAAQC,UAASC,EAAaD,KAC9BR,EAkBT,SAASS,EAAcD,GACrBT,IAAMW,EAAMF,EAAMG,QAAQN,GAErBK,IAILF,EAAME,IAAMA,EACZF,EAAMI,kBACJd,GAAUA,EAAOU,UACVA,EAAMG,QAAQN,KAIzBN,IAAMc,EAAW,IAAIC,qBAvBrB,SAAyBC,GACvBA,EAAQR,iBAAQS,GACVA,EAAMC,kBAAoB,IAC5BJ,EAASK,UAAUF,EAAMG,QACzBV,EAAaO,EAAMG,wBAVNC,qBAGjBC,IA8BF,OAFArB,EAAOO,iBAAQC,UAASK,EAASS,QAAQd,KAElCR"}